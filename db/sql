-- Database: invitame_una_cerveza

-- DROP DATABASE invitame_una_cerveza;

CREATE DATABASE inivitame_una_cerveza;
	
	
CREATE TABLE USUARIO
(
	ID  				SERIAL PRIMARY KEY,
	CORREO 				TEXT NOT NULL,
	FECHA_NACIMIENTO	DATE NOT NULL,
	CONTRASENA_TOKEN	TEXT NOT NULL,
	SALDO				TEXT NOT NULL
);

CREATE TABLE TIPO_CERVEZA
(
	ID  				SERIAL PRIMARY KEY,
	NOMBRE				TEXT NOT NULL
);

CREATE TABLE TIPO_PAGO
(
	ID  				SERIAL PRIMARY KEY,
	NOMBRE				TEXT NOT NULL
);

CREATE TABLE USUARIO_CERVEZA
(
	ID  				SERIAL PRIMARY KEY,
	CERVEZA_ID			INT NOT NULL,
	USUARIO_ID			INT NOT NULL,
	TIPO_PAGO_ID		INT NOT NULL,
	FECHA_VISITA		TIMESTAMP NOT NULL,
	_TOKEN				TEXT NOT NULL,
	PRODUCTO_PAGO		TEXT NOT NULL,
	QR					TEXT NOT NULL,
	CLIMA				TEXT NOT NULL
);

CREATE TABLE CERVEZA
(
	ID  				SERIAL PRIMARY KEY,
	BAR_ID				INT NOT NULL,
	TIPO_CERVEZA_ID		INT NOT NULL,
	NOMBRE				TEXT NOT NULL,
	PRECIO				TEXT NOT NULL,
	GRADOS_ALCOHOL		TEXT NOT NULL,
	IBU					TEXT NOT NULL,
	SRM					TEXT NOT NULL,
	DESCRIPCION			TEXT NOT NULL,
	IMAGEN				TEXT NOT NULL
);

CREATE TABLE BAR
(
	ID  				SERIAL PRIMARY KEY,
	NOMBRE				TEXT NOT NULL,
	FECHA_APERTURA		DATE NOT NULL,
	HORA_APERTURA		TEXT NOT NULL,
	HORA_CIERRE			TEXT NOT NULL,
	DIAS_ABIERTO		CHAR(1) NOT NULL,
	PRODUCTO_PAGO		TEXT NOT NULL,
	DESCRIPCION			TEXT NOT NULL,
	IMAGEN				TEXT NOT NULL,
	DIRECCION			TEXT NOT NULL,
	PUNTOS				INT	 NOT NULL
);


CREATE TABLE ACOMPANAMIENTO
(
	ID					SERIAL PRIMARY KEY,
	NOMBRE				TEXT NOT NULL,
	IMAGEN				TEXT NOT NULL,
	CERVEZA_ID			INT	 NOT NULL
);

/* CONSTRAINTS */


ALTER TABLE ACOMPANAMIENTO
ADD CONSTRAINT fk_cerveza_acompanamiento
FOREIGN KEY (CERVEZA_ID)
REFERENCES CERVEZA (ID);

ALTER TABLE CERVEZA
ADD CONSTRAINT fk_bar_cerveza
FOREIGN KEY (BAR_ID)
REFERENCES BAR (ID);

ALTER TABLE CERVEZA
ADD CONSTRAINT fk_cerveza_tipo_cerveza
FOREIGN KEY (TIPO_CERVEZA_ID)
REFERENCES TIPO_CERVEZA (ID);

ALTER TABLE USUARIO_CERVEZA
ADD CONSTRAINT fk_usuario_cerveza_cerveza
FOREIGN KEY (CERVEZA_ID)
REFERENCES CERVEZA (ID);

ALTER TABLE USUARIO_CERVEZA 
ADD CONSTRAINT fk_usuario_cerveza_usuario
FOREIGN KEY (USUARIO_ID)
REFERENCES USUARIO (ID);