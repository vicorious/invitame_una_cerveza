-- Database: invitame_una_cerveza

-- DROP DATABASE invitame_una_cerveza;

CREATE TABLE USUARIO
(
	ID  				SERIAL PRIMARY KEY,
	CORREO 				TEXT NOT NULL,
	FECHA_NACIMIENTO	DATE NOT NULL,
	CONTRASENA_TOKEN	TEXT NOT NULL,
	SALDO_POSITIVO		INT NOT NULL,
	FOTO				TEXT NOT NULL
);

CREATE TABLE TIPO_CERVEZA
(
	ID  				SERIAL PRIMARY KEY,
	NOMBRE				TEXT NOT NULL
);

CREATE TABLE TIPO_PAGO
(
	ID  				SERIAL PRIMARY KEY,
	NOMBRE				TEXT NOT NULL
);

CREATE TABLE USUARIO_CERVEZA
(
	ID  				SERIAL PRIMARY KEY,
	CERVEZA_ID			INT NOT NULL,
	USUARIO_ID			INT NOT NULL,
	TIPO_PAGO_ID		INT NOT NULL,
	FECHA_VISITA		TIMESTAMP NOT NULL,
	_TOKEN				TEXT NOT NULL,
	PRODUCTO_PAGO		TEXT NOT NULL,
	QR					TEXT NOT NULL,
	CLIMA				TEXT NOT NULL
);

CREATE TABLE CERVEZA
(
	ID  				SERIAL PRIMARY KEY,
	BAR_ID				INT NOT NULL,
	TIPO_CERVEZA_ID		INT NOT NULL,
	NOMBRE				TEXT NOT NULL,
	PRECIO				TEXT NOT NULL,
	PRECIO_HAPPY_HOUR	TEXT NOT NULL,
	GRADOS_ALCOHOL		TEXT NOT NULL,
	IBU					TEXT NOT NULL,
	SRM					TEXT NOT NULL,
	DESCRIPCION			TEXT NOT NULL,
	IMAGEN				TEXT NOT NULL,
	PINTA				BOOLEAN NOT NULL,
	COPA330				BOOLEAN NOT NULL,
	JIRAFA				BOOLEAN NOT NULL,
	JARRA				BOOLEAN NOT NULL
);

CREATE TABLE BAR
(
	ID  				SERIAL PRIMARY KEY,
	NOMBRE				TEXT NOT NULL,
	FECHA_APERTURA		DATE NOT NULL,
	HORA_APERTURA		TEXT NOT NULL,
	HORA_CIERRE			TEXT NOT NULL,
	DIAS_ABIERTO		CHAR(1) NOT NULL,
	PRODUCTO_PAGO		TEXT NOT NULL,
	DESCRIPCION			TEXT NOT NULL,
	IMAGEN				TEXT NOT NULL,
	DIRECCION			TEXT NOT NULL,
	PUNTOS				INT NOT NULL,
	FACEBBOK 			TEXT,
	TWITTER				TEXT,
	INSTAGRAM			TEXT
);

CREATE TABLE CLIMATE
(
	ID SERIAL PRIMARY KEY,
	DAY TEXT NOT NULL,
	HOUR TEXT NOT NULL,
	SUN TEXT NOT NULL,
	CLOUDS TEXT NOT NULL,
	WIND TEXT NOT NULL,
	HUMIDITY TEXT NOT NULL
);

CREATE TABLE ACOMPANAMIENTO
(
	ID SERIAL PRIMARY KEY,
	NOMBRE TEXT NOT NULL,
	IMAGEN TEXT NOT NULL,
	CERVEZA_ID INT NOT NULL
);

ALTER TABLE ACOMPANAMIENTO
ADD CONSTRAINT fk_acompanamiento_cerveza
FOREIGN KEY (CERVEZA_ID)
REFERENCES CERVEZA(ID);

ALTER TABLE USUARIO_CERVEZA
ADD CONSTRAINT fk_user_cerveza
FOREIGN KEY (CERVEZA_ID)
REFERENCES CERVEZA(ID);

ALTER TABLE USUARIO_CERVEZA
ADD CONSTRAINT fk_cerveza_user
FOREIGN KEY (USUARIO_ID)
REFERENCES USUARIO(ID);

ALTER TABLE USUARIO_CERVEZA
ADD CONSTRAINT fk_tipo_pago_user_cerveza
FOREIGN KEY (TIPO_PAGO_ID)
REFERENCES TIPO_PAGO(ID);

ALTER TABLE USUARIO_CERVEZA
ADD CONSTRAINT fk_clima_user_cerveza
FOREIGN KEY (CLIMA_ID)
REFERENCES CLIMATE(ID);

ALTER TABLE CERVEZA
ADD CONSTRAINT fk_cerveza_bar
FOREIGN KEY (BAR_ID)
REFERENCES BAR(ID);

ALTER TABLE CERVEZA
ADD CONSTRAINT fk_bar_tipo_cerveza
FOREIGN KEY (TIPO_CERVEZA_ID)
REFERENCES TIPO_CERVEZA(ID);


